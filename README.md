# –•—ç—à-—Ç–∞–±–ª–∏—Ü–∞
## –û –ø—Ä–æ–µ–∫—Ç–µ
–í —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ö—ç—à-—Ç–∞–±–ª–∏—Ü–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∫–æ–ª–ª–∏–∑–∏–π –º–µ—Ç–æ–¥–æ–º —Ü–µ–ø–æ—á–µ–∫. –í –ø–µ—Ä–≤–æ–π —á–∞—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ –±—ã–ª–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–π. –í–æ –≤—Ç–æ—Ä–æ–π —á–∞—Å—Ç–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≤–æ–¥–∏–ª–∞—Å—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç—Ä–µ—Ö –º–µ—Ç–æ–¥–æ–≤: 
1) –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è AVX; 
2) –≤—Å—Ç–∞–≤–∫–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –∫–æ–¥–∞ –Ω–∞ –∞—Å—Å–µ–º–±–ª–µ—Ä–µ; 
3) –∑–∞–º–µ–Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞–ø–∏—Å–∞–Ω–∞ –Ω–∞ –∞—Å—Å–µ–º–±–ª–µ—Ä–µ.

## –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å—Ç—É–ø–ª–µ–Ω–∏–µ
–î–ª—è —Ç–µ—Ö, –∫—Ç–æ –≤–ø–µ—Ä–≤—ã–µ –≤—Å—Ç—Ä–µ—Ç–∏–ª—Å—è —Å —ç—Ç–∏–º –ø–æ–Ω—è—Ç–∏–µ–º, –±—ã—Å—Ç—Ä–æ –æ–±—ä—è—Å–Ω—é —Å—É—Ç—å —Ö—ç—à-—Ç–∞–±–ª–∏—Ü.

*–•—ç—à-—Ç–∞–±–ª–∏—Ü–∞* - —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –≤ –∫–æ—Ç–æ—Ä–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –ø–∞—Ä–∞–º–∏: –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç - "–∫–ª—é—á", –≤—Ç–æ—Ä–æ–π - "–∑–Ω–∞—á–µ–Ω–∏–µ". –ü–æ–∏—Å–∫ –ø–æ —Ö—ç—à-—Ç–∞–±–ª–∏—Ü–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –≤—ã—Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç –∫–ª—é—á–∞. –ü–æ–ª—É—á–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±—É–¥–µ—Ç —è–≤–ª—è—Ç—å—Å—è –∏–Ω–¥–µ–∫—Å–æ–º —è—á–µ–π–∫–∏ –≤ —Ö—ç—à-—Ç–∞–±–ª–∏—Ü–µ, –≥–¥–µ –ª–µ–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è —ç—Ç–æ–º—É –∫–ª—é—á—É. –ü—Ä–∏–º–µ—Ä, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –≤—Å—ë —Å—Ç–∞–Ω–µ—Ç —è—Å–Ω–æ. –ü—É—Å—Ç—å –µ—Å—Ç—å –¥–æ–º, –≤ –Ω—ë–º 4 –∫–æ–º–Ω–∞—Ç—ã: "–∑–µ–ª—ë–Ω–∞—è", "–∫—Ä–∞—Å–Ω–∞—è", "—Å–∏–Ω—è—è", "—Å–µ—Ä–∞—è". –í "—Å–µ—Ä–æ–π" –∫–æ–º–Ω–∞—Ç–µ –ª–µ–∂–∏—Ç –≥–æ—Ä–∞ –∞–ª–º–∞–∑–æ–≤, –≤ "—Å–∏–Ω–µ–π" - –≥–æ—Ä–∞ —Å–∞–ø—Ñ–∏—Ä–æ–≤, –≤ "–∫—Ä–∞—Å–Ω–æ–π" - –≥–æ—Ä–∞ —Ä—É–±–∏–Ω–æ–≤, –≤ "–∑–µ–ª—ë–Ω–æ–π" - –≥–æ—Ä–∞ –∏–∑—É–º—Ä—É–¥–æ–≤. –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ–≥–¥–∞ –µ–π –ø–µ—Ä–µ–¥–∞–µ—à—å —Å–ª–æ–≤–æ "–∑–µ–ª—ë–Ω–∞—è", –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0, –∫–æ–≥–¥–∞ –ø–µ—Ä–µ–¥–∞—ë—à—å "–∫—Ä–∞—Å–Ω–∞—è" - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 1, –∫–æ–≥–¥–∞ –ø–µ—Ä–µ–¥–∞—ë—à—å "—Å–∏–Ω—è—è" - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 2, –∫–æ–≥–¥–∞ –ø–µ—Ä–µ–¥–µ–∞—ë—à—å "—Å–µ—Ä–∞—è" - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 3. –≠—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –±—É–¥—É—Ç –∏–Ω–¥–µ–∫—Å–∞–º–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Ö—ç—à-—Ç–∞–±–ª–∏—Ü–µ, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∏–º–µ—Ç—å –≤–∏–¥:
| 0 | 1 | 2  | 3 |
| ------------- | ------------- | ------------- | ------------- |
| "–∑–µ–ª—ë–Ω–∞—è"  | "–∫—Ä–∞—Å–Ω–∞—è"  | "—Å–∏–Ω—è—è"  | "—Å–µ—Ä–∞—è"  |
| –∏–∑—É–º—Ä—É–¥—ã  | —Ä—É–±–∏–Ω—ã  | —Å–∞–ø—Ñ–∏—Ä—ã  | –∞–ª–º–∞–∑—ã  |

–¢–æ –µ—Å—Ç—å –≤—Ä–µ–º—è –ø–æ–∏—Å–∫–∞ –ø–æ –Ω–µ–π –±—É–¥–µ—Ç —Å–æ—Å—Ç–∞–≤–ª—è—Ç—å O(1) - –ø—Ä–æ—Å—Ç–æ –Ω–∞–∑–æ–≤–∏—Ç–µ —Å–ª–æ–≤–æ –∏ –ø–æ–ª—É—á–∏—Ç–µ –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –µ–º—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç.

## –ß–∞—Å—Ç—å 1 - –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ö—ç—à-—Ñ—É–∫–Ω—Ü–∏–π
### Hash function returning 1
–û—Ö... üò¨ –≠—Ç–∞ —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏—è —Å–∞–º–∞—è —É–∂–∞—Å–Ω–∞—è –∏–∑ —Ç–µ—Ö, —á—Ç–æ –≤—ã —É–≤–∏–¥–∏—Ç–µ –∑–¥–µ—Å—å. –û–Ω–∞ –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 1.

```c
size_t hashRet1 (char * word, size_t length)
{
    return 1;
}
```

![–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏](./imgs/alw_ret_1.png)

### Hash function returning 1-st byte
–ß—É—Ç—å –ª—É—á—à–µ, —á–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∞—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 1-—ã–π –±–∞–π—Ç —Å–ª–æ–≤–∞ –≤ –∫–æ–¥–∏—Ä–æ–≤–∫–µ ASCII. –î–ª—è —É–∑–∫–æ–≥–æ –∫—Ä—É–≥–∞ –∑–∞–¥–∞—á –æ–Ω–∞ –º–æ–∂–µ—Ç –ø–æ–¥–æ–π—Ç–∏, –Ω–æ –≤—Å—ë —Ä–∞–≤–Ω–æ –±–µ–∑—É–º–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–ª–ª–∏–∑–∏–π. 

```c
size_t hashFirstByte (char * word, size_t length)
{
    return word[0];
}
```

![–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏](./imgs/first_byte.png)

### HashLength
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–ª–∏–Ω—É —Å–ª–æ–≤–∞. –•—ç—à-—Ñ—É–Ω–∫—Ü–∏—è —Ç–∞–∫ –∂–µ –ø–ª–æ—Ö–∞, –Ω–æ... –æ–Ω–∞ —Ö–æ—Ç—è –±—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å –≤ –Ω–∞—É—á–Ω–æ–º –ø–ª–∞–Ω–µ: —Ç–µ–ø–µ—Ä—å –º—ã –∑–Ω–∞–µ–º —Å—Ä–µ–¥–Ω—é—é –¥–ª–∏–Ω—É —Å–ª–æ–≤–∞ –≤ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —Ç–µ–∫—Å—Ç–µ :grin:

```c
size_t hashLength (char * word, size_t length)
{
    return length;
}
```

![–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏](./imgs/length.png)

### HashSum
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—É–º–º—É ASCII-–∫–æ–¥–æ–≤ –±—É–∫–≤ —Å–ª–æ–≤–∞. –°–∏—Ç—É–∞—Ü–∏—è —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ª—É—á—à–µ.

```c
size_t hashSumAscii (char * word, size_t length)
{
    size_t sum = 0;
    for (size_t i = 0; i < length; i++)
    {
        sum += word[i];
    }

    return sum;
}
```

![–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏](./imgs/sum.png)

### HashRol
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é rol. –í–ø–æ–ª–Ω–µ –ø—Ä–∏–µ–º–ª–µ–º–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ–ª–ª–∏–∑–∏–π –Ω–µ —Ç–∞–∫ –º–Ω–æ–≥–æ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏.

```c—Ç–∞–∫–∞—è
size_t hashRol (char * word, size_t length)
{
    size_t h = 0;
    for (size_t i = 0; i < length; i++)
    {
        h = rol(h)^word[i];
    }
    return h;
}
```

![–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏](./imgs/rol.png)

### HashRor
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é ror. –ù–µ—Å–∫–æ–ª—å–∫–æ —Ö—É–∂–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–π, –Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–¥–∞—á–∞—Ö –º–æ–∂–Ω–æ.

```c
size_t hashRor (char * word, size_t length)
{
    size_t h = 0;
    for (size_t i = 0; i < length; i++)
    {
        h = ror(h)^word[i];
    }
    return h;
}
```
![–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏](./imgs/ror.png)

### HashBkdr
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏ BKDR. –õ—É—á—à–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤ —ç—Ç–æ–π –ø–æ–¥–±–æ—Ä–∫–µ.

```c
size_t hashBkdr (char * word, size_t lengthWord)
{
    unsigned int seed = 131;
    unsigned int hash = 0;

    while (*word){
        hash = hash * seed + (*word++);
    }

    return (hash & 0x7FFFFFFF);
}
```
![–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏](./imgs/bkdr.png)

## –í—ã–≤–æ–¥
–õ—É—á—à–µ –≤—Å–µ–≥–æ —Å–µ–±—è –ø–æ–∫–∞–∑–∞–ª–∞ –ø–æ—Å–ª–µ–¥–Ω—è—è —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏—è BKDR. –ò–º–µ–Ω–Ω–æ –µ—ë –∏–∑ –≤—Å–µ—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö —è –±—ã —Å–æ–≤–µ—Ç–æ–≤–∞–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ —Ç–µ–∫—Å—Ç–∞, —Ç–∞–∫ –∫–∞–∫ –ø–æ–∏—Å–∫ –ø–æ —Ö—ç—à-—Ç–∞–±–ª–∏—Ü–µ, –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Å –µ—ë –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º, –±—É–¥–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—ã—Å—Ç—Ä—ã–º.


## –ß–∞—Å—Ç—å 2 - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### –í–µ—Ä—Å–∏—è 0
–£–¥–∞–ª–µ–Ω—ã –≤—Å–µ —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏ –∫—Ä–æ–º–µ hashBkdr, –∫–æ—Ç–æ—Ä—É—é –º—ã –≤–∑—è–ª–∏ –∑–∞ –æ—Å–Ω–æ–≤–Ω—É—é, —É–±—Ä–∞–Ω—ã –≤—Å–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –¥–æ–±–∞–≤–ª–µ–Ω —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç. –î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –≤—Ä–µ–º—è, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã, —Å–æ—Å—Ç–∞–≤–ª—è–ª–æ –º–∞–ª—É—é —á–∞—Å—Ç—å –æ—Ç —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ htFind, –±—É–¥–µ–º —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –≤ —Ü–∏–∫–ª–µ –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ —Ç–æ, –≤–æ —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –º—ã —ç—Ç–æ —É–≤–µ–ª–∏—á–∏–º –∏—Ö, –Ω–µ —Å—Ä–∞–≤–Ω—è–ª–æ—Å—å —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ä–∞–∑–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã. –¢–∞–∫, –º—ã –ø–æ–ª—É—á–∏–º 100000000 –æ–±–æ—Ä–æ—Ç–æ–≤. –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã —Ä–∞–≤–Ω–æ 17.328 —Å–µ–∫—É–Ω–¥–∞–º. –û–±—Ä–∞—Ç–∏–º—Å—è –∫ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤—â–∏–∫—É –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫–∏–µ —á–∞—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã —è–≤–ª—è—é—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ "–≥–æ—Ä—è—á–∏–º–∏". 

![–í–µ—Ä—Å–∏—è 0](./imgs/version0.png)

–í–∏–¥–Ω–æ, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è hashBkdr —Ç—Ä–∞—Ç–∏—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Ä–µ—Å—É—Ä—Å–æ–≤. –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –µ—ë. –î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–ø–∏—à–µ–º –µ—ë –Ω–∞ –∞—Å—Å–µ–º–±–ª–µ—Ä–µ. –ó–∞–º–µ—Ç—å—Ç–µ, —á—Ç–æ —ç—Ç–æ –Ω–∞—Ä—É—à–∏—Ç –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã, –æ–¥–Ω–∞–∫–æ –º–æ–∂–µ—Ç —É—Å–∫–æ—Ä–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–∞ —ç—Ç–æ–π –º–∞—à–∏–Ω–µ. 

### –í–µ—Ä—Å–∏—è 1
–§—É–Ω–∫—Ü–∏—è hashBkdr –∑–∞–º–µ–Ω–µ–Ω–∞ –Ω–∞ –∞—Å—Å–µ–º–±–ª–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–æ–≥. –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤ —Å—Ä–µ–¥–Ω–µ–º —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 16.092 —Å–µ–∫—É–Ω–¥—ã. –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–≤–µ–Ω 17.328/16.092. 

–ê—Å—Å–µ–º–±–ª–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–æ–≥ —Ñ—É–Ω–∫—Ü–∏–∏ hashBkdr:
```asm
hashBkdr:
push rdx
push rbx
push rcx


xor rax, rax             ; hash
mov rbx, 131             ; coefficient
xor rcx, rcx   
.loop:
movzx rcx, byte [rdi]    ; word

test rcx, rcx
jz .end

mul rbx

lea rax, [rax + rcx]
inc rdi
jmp .loop

.end:
and eax, 0x7fffffff

pop rcx
pop rbx
pop rdx
ret
```

–°–Ω–æ–≤–∞ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤—â–∏–∫–∞:

![–í–µ—Ä—Å–∏—è 1](./imgs/version1.png)

–í–∏–¥–Ω–æ, —á—Ç–æ `__libc_start_call_main` —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Ä–µ—Å—É—Ä—Å–æ–≤, –æ–¥–Ω–∞–∫–æ —ç—Ç–æ —Å–∏—Å—Ç–µ–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –µ—ë –º—ã –Ω–µ —Å–º–æ–∂–µ–º. –ü–æ–ø—Ä–æ–±—É–µ–º –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å `strlen` –∏ `memcmp`. –í–∏–¥–Ω–æ, —á—Ç–æ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª avx2-–∞–Ω–∞–ª–æ–≥–∏ —ç—Ç–∏—Ö —Ñ—É–∫–Ω—Ü–∏–π, –Ω–æ, –±—ã—Ç—å –º–æ–∂–µ—Ç, –º—ã —Å–ø—Ä–∞–≤–∏–º—Å—è –ª—É—á—à–µ.

### –í–µ—Ä—Å–∏—è 2
–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞—Ç—å avx2 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏, –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –±—É–¥–µ–º —Ö—Ä–∞–Ω–∏—Ç—å –≤ –æ–±–ª–∞—Å—Ç–∏ —Ä–∞–∑–º–µ—Ä–æ–º 256 –±–∏—Ç. –≠—Ç–æ –±—É–¥–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –æ—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏, –æ–¥–Ω–∞–∫–æ —ç—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —É—Å–∫–æ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø—Ä–æ–≥—Ä–∞–º–º—ã. –¢–∞–∫–∂–µ –Ω–µ –∑–∞–±—É–¥–µ–º –≤—ã—Ä–æ–≤–Ω—è—Ç—å —è—á–µ–π–∫–∏ –ø–∞–º—è—Ç–∏, –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Å–ª–æ–≤–∞, –ø–æ 32-–±–∞–π—Ç–Ω–æ–π –≥—Ä–∞–Ω–∏—Ü–µ. –ü–æ—Å–∫–æ–ª—å–∫—É —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ –¥–ª—è —Å–ª–æ–≤–∞ –ø–æ—Å—Ç–æ—è–Ω–µ–Ω, –ø–æ—Å—Ç–æ–ª—å–∫—É –º—ã –º–æ–∂–µ–º –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç `strlen`.

memcmpAvx:
```c
static int memcmpAvx (const void * str1, const void * str2, size_t length)
{
    __m256i ar1 = _mm256_loadu_si256 ((__m256i *) str1);
    __m256i ar2 = _mm256_loadu_si256 ((__m256i *) str2);

    __m256i cmp = _mm256_cmpeq_epi8 (ar1, ar2);
    int mask = _mm256_movemask_epi8 (cmp);

    if (mask == 0xffffffff)
    {
        return 0;
    }
    return 1;
}
```

memcmpAsm:
```c
inline static int memcmpAsm (const void * str1, const void * str2, size_t length)
{
    int result = 0; 

    asm
    (
        ".intel_syntax noprefix\n\t"
        "cld\t\n"
        "repe cmpsb\t\n"
        "je .eq\t\n"
        ".noeq:\t\n"
        "dec %1\t\n"
        "dec %2\t\n"
        "mov %0, [%1]\t\n"
        "sub %0, [%2]\t\n"
        "jmp .end\t\n"
        ".eq:\t\n"
        "mov %0, 0\t\n"
        ".end:\t\n"
        ".att_syntax\t\n"
        : "=a" (result)
        : "S" (str1), "D" (str2), "c" (length)
    );

    return result;
}
```

–ò–∑–º–µ—Ä–µ–Ω–∏—è –ø–æ–∫–∞–∑–∞–ª–∏, —á—Ç–æ –Ω–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è memcmp –ø—Ä–∏ –ø–æ–º–æ—â–∏ AVX –∏ —Å —É—Å—Ç—É–ø–∞–µ—Ç `__memcmp_avx2_movbe`.

|__memcmp_avx2_movbe| memcmpAvx |   memcmpAsm   |
| ------------- | ------------- | ------------- |
|     15.561    |     17.026    |     17.908    |

–ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤—â–∏–∫–∞:

![–í–µ—Ä—Å–∏—è 2](./imgs/version2.png)

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∫ –Ω–∞—à–∏–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º —Å–∫–æ–ø–º–∏–ª–∏—Ä—É–µ–º –ø—Ä–æ–µ–∫—Ç c –ø–æ–º–æ—â—å—é —Ñ–ª–∞–≥–∞ -O3 –∏ –∏–∑–º–µ—Ä–∏–º –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.
–†–µ–∑—É–ª—å—Ç–∞—Ç: 14.932 —Å–µ–∫—É–Ω–¥.

–ó–∞–ø—É—Å—Ç–∏–º –≤–µ—Ä—Å–∏—é –ø—Ä–æ–µ–∫—Ç–∞ –±–µ–∑ —Ä—É—á–Ω—ã—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π —Å —Ñ–ª–∞–≥–æ–º -O3.
–†–µ–∑—É–ª—å—Ç–∞—Ç: 17.250 —Å–µ–∫—É–Ω–¥.

–ù–∞ —ç—Ç–æ–º –º—ã –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ–º –Ω–∞—à —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç.

## –í—ã–≤–æ–¥

–û–±—â–∏–π –ø—Ä–∏—Ä–æ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 86% –ø–æ —Ç–∞–∫—Ç–∞–º. 
–†–∞—Å—Å—á–∏—Ç–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –æ–ø—Ä–∞–≤–¥–∞–Ω–Ω–æ—Å—Ç–∏ –Ω–∞—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π –ø–æ —Ñ–æ—Ä–º—É–ª–µ:
```math
\frac{\text{acceleration value}}{\text{number of assembly lines}} \cdot 1000
```

–ù–µ –±—É–¥–µ–º —É—á–∏—Ç—ã–≤–∞—Ç—å –∏–º–µ–Ω–∞ –º–µ—Ç–æ–∫, –Ω–∞–∑–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø–æ–ª—É—á–∏–º: 
![counting](https://latex.codecogs.com/svg.image?\frac{1.86}{13}&space;*&space;1000&space;=&space;143.07)
